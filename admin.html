<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®é”å…§éƒ¨ - å®¢æˆ¶éˆæ¥ç¸½æ§å°</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffc107">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <style>
        body { background-color: #f0f2f5; font-family: "Microsoft JhengHei", sans-serif; padding-bottom: 50px; }
        .header { background: #212529; color: #ffc107; padding: 15px; text-align: center; font-weight: bold; font-size: 1.1rem; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        /* å°èˆªæŒ‰éˆ•æ¨£å¼ */
        .nav-pills .nav-link { color: #555; font-weight: bold; background: white; margin: 0 4px; border: 1px solid #ddd; border-radius: 20px; font-size: 0.95rem; padding: 8px 15px; }
        .nav-pills .nav-link.active { background-color: #ffc107; color: black; border-color: #ffc107; }
        .nav-scroll { overflow-x: auto; white-space: nowrap; padding-bottom: 15px; -webkit-overflow-scrolling: touch; }
        
        /* === å¡ç‰‡æ¨£å¼ (V2.6 èˆ’é©ç‰ˆ) === */
        .client-card { 
            background: white; 
            border-radius: 10px; 
            padding: 16px 15px; /* é«˜åº¦èˆ’é© */
            margin-bottom: 15px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
            display: flex; 
            flex-direction: row; 
            justify-content: space-between; 
            align-items: center; 
            border-left: 5px solid #ddd; 
            gap: 10px; 
        }
        
        /* === å·¦å´ä¿¡æ¯ === */
        .client-info { 
            flex: 1; 
            min-width: 0; 
            margin-right: 5px;
        }
        .c-name { 
            font-size: 1.1rem; /* å­—é«”å¤§ */
            font-weight: bold; 
            color: #333; 
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis; 
            margin-bottom: 2px;
            line-height: 1.3;
        }
        .c-code { 
            font-size: 0.8rem; 
            color: #999; 
            font-family: monospace; 
        }
        
        /* === å³å´æŒ‰éˆ•çµ„ === */
        .btn-group-custom { 
            display: flex; 
            gap: 8px; 
            flex-shrink: 0; 
        }
        
        /* === æŒ‰éˆ•æ¨£å¼ === */
        .btn-action { 
            border: none;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            padding: 8px 14px;
            border-radius: 6px;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            white-space: nowrap;
            transition: opacity 0.2s;
        }
        .btn-action:hover { color: white; opacity: 0.9; }
        .btn-action:active { transform: scale(0.96); }

        .btn-blue { background-color: #0d6efd; }
        .btn-green { background-color: #198754; }
        .btn-dark { background-color: #212529; } /* æ–°å®¢æˆ¶æ¨™ç±¤ç”¨æ·±è‰² */
        
    </style>
</head>
<body>

<div class="header">
    ğŸ¯ å®é”å®¢æˆ¶éˆæ¥åˆ†ç™¼ä¸­å¿ƒ
</div>

<div class="container">
    <div class="nav-scroll">
        <ul class="nav nav-pills justify-content-center mb-3" id="salesTabs">
            <li class="nav-item"><button class="nav-link" onclick="filterSales('NEW')"><i class="bi bi-people-fill"></i> æ–°å®¢æˆ¶å°ˆç”¨</button></li>
            
            <li class="nav-item"><button class="nav-link active" onclick="filterSales('A')">å¿—å“¥ (A)</button></li>
            <li class="nav-item"><button class="nav-link" onclick="filterSales('E')">äºŒä½¬ (E)</button></li>
            <li class="nav-item"><button class="nav-link" onclick="filterSales('B')">åšå£« (B)</button></li>
            <li class="nav-item"><button class="nav-link" onclick="filterSales('C')">å«¦å§ (C)</button></li>
            <li class="nav-item"><button class="nav-link" onclick="filterSales('D')">David (D)</button></li>
        </ul>
    </div>

    <div id="clientListArea"></div>
</div>

<script src="customers.js"></script>
<script>
    const baseUrl = "https://hkwangtat-order.github.io/new-clients/index.html";

    function init() {
        filterSales('A'); // é»˜èªé¡¯ç¤ºå¿—å“¥
    }

    function filterSales(salesCode) {
        // 1. æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.nav-link').forEach(btn => {
            btn.classList.remove('active');
            // åˆ¤æ–·æŒ‰éˆ•æ–‡å­—æ˜¯å¦åŒ…å«éŠ·å”®ä»£ç¢¼ï¼Œæˆ–è€…ç‰¹æ®Šè™•ç† NEW
            if(salesCode === 'NEW' && btn.innerText.includes('æ–°å®¢æˆ¶')) {
                btn.classList.add('active');
            } else if (salesCode !== 'NEW' && btn.innerText.includes(`(${salesCode})`)) {
                btn.classList.add('active');
            }
        });

        const container = document.getElementById('clientListArea');
        container.innerHTML = ''; 

        // === åˆ†æ”¯ 1ï¼šå¦‚æœæ˜¯é»æ“Šã€Œæ–°å®¢æˆ¶å°ˆç”¨ã€ ===
        if (salesCode === 'NEW') {
            const salesTeam = [
                { name: "å¿—å“¥ (A)", code: "A" },
                { name: "äºŒä½¬ (E)", code: "E" },
                { name: "åšå£« (B)", code: "B" },
                { name: "å«¦å§ (C)", code: "C" },
                { name: "David (D)", code: "D" }
            ];

            let html = '';
            salesTeam.forEach(s => {
                // âš ï¸ æ³¨æ„ï¼šæ–°å®¢æˆ¶ç”¨çš„æ˜¯ ?sales=X åƒæ•¸
                const link = `${baseUrl}?sales=${s.code}`;
                // é€šç”¨å•å€™èª
                const msg = `ä½ å¥½ï¼Œé€™æ˜¯å®é”ç‚ºæ‚¨æº–å‚™çš„é›»å­è½å–®éˆæ¥ï¼Œè«‹é»æ“Šä¸‹å–®ï¼š\n${link}`;
                const waLink = `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`;

                html += `
                    <div class="client-card" style="border-left-color: #333">
                        <div class="client-info">
                            <div class="c-name">${s.name} çš„æ–°å®¢æˆ¶</div>
                            <div class="c-code">é€šç”¨éˆæ¥ (General Link)</div>
                        </div>
                        
                        <div class="btn-group-custom">
                            <a href="${link}" target="_blank" class="btn-action btn-blue">
                                <i class="bi bi-search"></i> æª¢æŸ¥
                            </a>
                            <a href="${waLink}" target="_blank" class="btn-action btn-green">
                                <i class="bi bi-whatsapp"></i> è½‰ç™¼
                            </a>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
            return; // çµæŸå‡½æ•¸
        }

        // === åˆ†æ”¯ 2ï¼šå¦‚æœæ˜¯é»æ“Šå…·é«”éŠ·å”® (èˆŠå®¢æˆ¶) ===
        // å€’åºæ’åˆ—
        let clientArray = Object.entries(clientDB).reverse();

        let found = false;
        let html = '';

        for (const [id, data] of clientArray) {
            if (data.sales === salesCode) {
                found = true;
                
                // âš ï¸ æ³¨æ„ï¼šè€å®¢æˆ¶ç”¨çš„æ˜¯ ?id=X åƒæ•¸
                const link = `${baseUrl}?id=${id}`;
                // å°ˆå±¬å•å€™èª
                const msg = `ä½ å¥½ ${data.name}ï¼Œé€™æ˜¯å®é”ç‚ºæ‚¨æº–å‚™çš„å°ˆå±¬é›»å­è½å–®éˆæ¥ï¼Œè«‹ä¿å­˜ï¼š\n${link}`;
                const waLink = `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`;

                html += `
                    <div class="client-card" style="border-left-color: ${getColor(salesCode)}">
                        <div class="client-info">
                            <div class="c-name">${data.name}</div>
                            <div class="c-code">${id}</div>
                        </div>
                        
                        <div class="btn-group-custom">
                            <a href="${link}" target="_blank" class="btn-action btn-blue">
                                <i class="bi bi-search"></i> æª¢æŸ¥
                            </a>
                            <a href="${waLink}" target="_blank" class="btn-action btn-green">
                                <i class="bi bi-whatsapp"></i> è½‰ç™¼
                            </a>
                        </div>
                    </div>
                `;
            }
        }

        if (!found) {
            container.innerHTML = '<div class="text-center text-muted mt-5">æš«ç„¡æ­¤éŠ·å”®çš„å®¢æˆ¶è³‡æ–™</div>';
        } else {
            container.innerHTML = html;
        }
    }

    function getColor(code) {
        const colors = { 'A': '#0d6efd', 'E': '#198754', 'B': '#dc3545', 'C': '#ffc107', 'D': '#6f42c1' };
        return colors[code] || '#ccc';
    }

    init();
</script>

</body>
</html>

